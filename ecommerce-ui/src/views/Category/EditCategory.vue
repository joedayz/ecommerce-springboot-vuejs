<template>

  <div class="container">
    <div class="row">
      <div class="col-12 text-center">
        <h3 class="pt-3">Edit Category</h3>
      </div>
    </div>
    <div class="row">
      <div class="col-3"></div>
      <form>
        <div class="form-group">
          <label>Category Name</label>
          <input type="text" class="form-control" v-model="categoryName" required>
        </div>
        <div class="form-group">
          <label>Description</label>
          <input type="text" class="form-control" v-model="description" required>
        </div>
        <div class="form-group">
          <label>ImageURL</label>
          <input type="url" class="form-control" v-model="imageUrl" required>
        </div>
        <button type="button" class="btn btn-primary" @click="editCategory">Submit</button>
      </form>
      <div class="col-3"></div>
    </div>

  </div>
</template>

<script>
  var axios = require('axios');
  import Swal from 'sweetalert2';

  export default {
    data(){
      return{
        id: null,
        categoryName: null,
        description: null,
        imageUrl: null,
        categoryIndex: null,
      }
    },
    props: [ "baseURL", "categories"],
    methods:{
      async editCategory(){
        const updatedCategory = {
          id: this.id,
          categoryName: this.categoryName,
          description: this.description,
          imageUrl: this.imageUrl,
        }

        await axios({
          method: 'post',
          url: this.baseURL + 'category/update/' + this.id,
          data: JSON.stringify(updatedCategory),
          headers: {
            'Content-Type': 'application/json',
          }
        })
            .then( () => {
              Swal.fire({
                text: "Category Updated Successfully!",
                icon: "success",
                allowOutsideClick: false,
              });
            })
            .catch((error) => console.log(error))

      }
    },
    mounted(){
      this.id = this.$route.params.id; // localhost:8080/categories/5
      this.category = this.categories.filter(category => category.id == this.id)[0];
      this.categoryName = this.category.categoryName;
      this.description = this.category.description;
      this.imageUrl = this.category.imageUrl;
    },
  }
</script>

<style scoped>
h4 {
  font-family: 'Roboto', sans-serif;
  color: #484848;
  font-weight: 700;
}
</style>